---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "prefect_block Resource - prefect"
subcategory: ""
description: |-
  The resource block allows creating and managing Prefect Blocks https://docs.prefect.io/latest/concepts/blocks/, which are primitives for configuration / secrets in your flows.
  block resources represent configurations for schemas for all different Block types. Because of the polymorphic nature of Blocks, you should utilize the prefect CLI https://docs.prefect.io/latest/getting-started/installation/ to inspect all Block types and schemas.
  Note: you should be on version 3.0.0rc1 or later to use the following commands:
  Use prefect block type ls to view all available Block type slugs, which is used in the type_slug attribute.
  Use prefect block type inspect <slug> to view the data schema for a given Block type. Use this to construct the data attribute value (as JSON string).
  NOTE: if a Block is managed in Terraform, the .data attribute will NOT be re-reconciled if the remote value is changed. This means that a TF-managed Block will only update the API, and not the other way around.
  This feature is available in the following product plan(s) https://www.prefect.io/pricing: Prefect OSS, Prefect Cloud (Free), Prefect Cloud (Pro), Prefect Cloud (Enterprise).
---

# prefect_block (Resource)


The resource `block` allows creating and managing [Prefect Blocks](https://docs.prefect.io/latest/concepts/blocks/), which are primitives for configuration / secrets in your flows.
`block` resources represent configurations for schemas for all different Block types. Because of the polymorphic nature of Blocks, you should utilize the `prefect` [CLI](https://docs.prefect.io/latest/getting-started/installation/) to inspect all Block types and schemas.
*Note:* you should be on version `3.0.0rc1` or later to use the following commands:
Use `prefect block type ls` to view all available Block type slugs, which is used in the `type_slug` attribute.
Use `prefect block type inspect <slug>` to view the data schema for a given Block type. Use this to construct the `data` attribute value (as JSON string).
*NOTE:* if a Block is managed in Terraform, the `.data` attribute will NOT be re-reconciled if the remote value is changed. This means that a TF-managed Block will only update the API, and not the other way around.

This feature is available in the following [product plan(s)](https://www.prefect.io/pricing): Prefect OSS, Prefect Cloud (Free), Prefect Cloud (Pro), Prefect Cloud (Enterprise).


## Example Usage

```terraform
# example:
# the data property will hold json encoded data
resource "prefect_block" "secret" {
  name      = "foo"
  type_slug = "secret"

  data = jsonencode({
    "value" = "bar"
  })

  # set the workpace_id attribute on the provider OR the resource
  workspace_id = "<workspace UUID>"
}

# example:
# you can also use file() to import a JSON file
# or even a templatefile() to import a JSON template file
resource "prefect_block" "aws_credentials_from_file" {
  name = "production-aws"

  # prefect block type ls
  type_slug = "aws-credentials"

  # prefect block type inspect aws-credentials
  data = file("./aws-credentials.json")
}

# example:
# Here's an end-to-end example of the gcp-credentials block
# holding a GCP service account key
resource "google_service_account" "test_bot" {
  display_name = "test-bot"
  account_id   = "test-bot"
}
resource "google_service_account_key" "test_bot" {
  service_account_id = google_service_account.test_bot.id
}
resource "prefect_block" "gcp_credentials_key" {
  name = "staging-gcp"

  # prefect block type ls
  type_slug = "gcp-credentials"

  # prefect block type inspect gcp-credentials
  data = jsonencode({
    "project"              = "my-gcp-project",
    "service_account_info" = jsondecode(base64decode(google_service_account_key.test_bot.private_key))
  })
}

# example:
# some resources need to be referenced using a "$ref" key
resource "prefect_block" "my_dbt_cli_profile" {
  name      = "my-dbt-cli-profile"
  type_slug = "dbt-cli-profile"

  data = jsonencode({
    "name"   = "mine"
    "target" = "prefect-dbt-profile"
  })
}
resource "prefect_block" "my_dbt_run_operation_block" {
  name      = "my-dbt-operations"
  type_slug = "dbt-core-operation"

  # note the "$ref" key wrapping the "block_document_id" reference
  data = jsonencode({
    "commands"        = ["dbt deps", "dbt seed", "dbt run"]
    "dbt_cli_profile" = { "$ref" : { "block_document_id" : prefect_block.my_dbt_cli_profile.id } }
  })
}
```

One of the examples above mentions the special syntax needed when referencing
other Terraform resources from within the `data` attribute. You can use `prefect
block type inspect` to confirm when this field is required.

For example, the following screenshot shows the output of `prefect block type inspect
dbt-core-operation`. It mentions the `$ref` key that the API expects.

<img src="https://raw.githubusercontent.com/PrefectHQ/terraform-provider-prefect/main/docs/images/block-type-inspect-ref-key.png" alt="Block type inspect ref key" align="center" width="400">

For more information on the `$ref` syntax definition, see the
[dollarref's specification in the JSON schema](https://json-schema.org/understanding-json-schema/structuring#dollarref).

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `data` (String, Sensitive) The user-inputted Block payload, as a JSON string. Use `jsonencode` on the provided value to satisfy the underlying JSON type. The value's schema will depend on the selected `type` slug. Use `prefect block type inspect <slug>` to view the data schema for a given Block type.
- `name` (String) Unique name of the Block
- `type_slug` (String) Block Type slug, which determines the schema of the `data` JSON attribute. Use `prefect block type ls` to view all available Block type slugs.

### Optional

- `account_id` (String) Account ID (UUID) where the Block is located
- `workspace_id` (String) Workspace ID (UUID) where the Block is located. In Prefect Cloud, either the `prefect_block` resource or the provider's `workspace_id` must be set.

### Read-Only

- `created` (String) Timestamp of when the resource was created (RFC3339)
- `id` (String) Block ID (UUID)
- `updated` (String) Timestamp of when the resource was updated (RFC3339)

## Import

Import is supported using the following syntax:

```shell
# prefect_block resources can be imported by the block_id
terraform import prefect_block.my_block 00000000-0000-0000-0000-000000000000
#
# or from a different workspace via block_id,workspace_id
terraform import prefect_block.my_block 00000000-0000-0000-0000-000000000000,11111111-1111-1111-1111-111111111111
```
